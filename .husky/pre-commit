#!/usr/bin/env sh
. "$(dirname "$0")/common.sh"

echo "===\n>> ë¸Œëœì¹˜ëª… ê²€ì‚¬ ì¤‘..."

# ë¸Œëœì¹˜ ë³´í˜¸ ê¸°ëŠ¥ì´ í™œì„±í™”ë˜ì–´ ìˆëŠ”ì§€ í™•ì¸
if [[ -z $SKIP_BRANCH_PROTECTION ]]; then
    BRANCH=$(git rev-parse --abbrev-ref HEAD)
    PROTECTED_BRANCHES="^(main|master|develop)"

    if [[ $BRANCH =~ $PROTECTED_BRANCHES ]]; then
        echo ">> ğŸš« $BRANCH ë¸Œëœì¹˜ì— ì§ì ‘ ì»¤ë°‹í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤. ê¸°ëŠ¥(feature) ë¸Œëœì¹˜ë¥¼ ìƒì„± í›„ ë³€ê²½ì‚¬í•­ ë°˜ì˜ PR ìš”ì²­í•´ì£¼ì„¸ìš”."
        exit 1
    fi
else
    echo ">> ë¸Œëœì¹˜ ë³´í˜¸ ê¸°ëŠ¥ì„ ê±´ë„ˆëœë‹ˆë‹¤."
fi

echo ">> ë¸Œëœì¹˜ëª… ê²€ì‚¬ ì™„ë£Œ"
echo ">> íŒŒì¼ ë¦°íŒ… ë° ìë™ ìˆ˜ì • ì¤‘..."

# pnpm type-check
pnpm lint-staged
